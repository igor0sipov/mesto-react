(this["webpackJsonpmesto-react"]=this["webpackJsonpmesto-react"]||[]).push([[0],{16:function(e,t,a){},17:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a(1),o=a.n(i),s=a(7),r=a.n(s),c=(a(16),a(10)),l=a(3),u=a(2),d=a.p+"static/media/logo_white.8724261e.svg";var p=function(){return Object(n.jsx)("header",{className:"header header_spaced",children:Object(n.jsx)("a",{href:"#",children:Object(n.jsx)("img",{src:d,alt:"\u041b\u043e\u0433\u043e \u0441\u0430\u0439\u0442\u0430",className:"header__logo"})})})},f=o.a.createContext();var h=function(e){var t=e.card.owner._id===e.currentUser._id,a=e.card.likes.some((function(t){return t._id===e.currentUser._id}));return Object(n.jsxs)("li",{className:"element",children:[Object(n.jsx)("button",{className:"element__delete-button ".concat(t?"":"element__delete-button_hidden"),onClick:function(){e.onDeleteClick(e.card)}}),Object(n.jsx)("img",{src:e.card.link,alt:"#",className:"element__picture",onClick:function(){e.onCardClick(e.card)}}),Object(n.jsx)("h2",{className:"element__name",children:e.card.name}),Object(n.jsxs)("figure",{className:"element__like",children:[Object(n.jsx)("button",{className:"element__like-button ".concat(a?"element__like-button_active":""),onClick:function(){e.onCardLike(e.card,a)}}),Object(n.jsx)("figcaption",{className:"element__like-counter",children:e.card.likes.length})]})]})},b=a.p+"static/media/edit-avatar-icon.ae1a976d.svg";var j=function(e){var t=o.a.useContext(f);return Object(n.jsxs)("main",{className:"main sizer",children:[Object(n.jsxs)("section",{className:"profile profile_spaced sizer",children:[Object(n.jsxs)("div",{className:"profile__avatar-wrapper",children:[Object(n.jsx)("img",{src:t.avatar,alt:"User Avatar",className:"profile__avatar"}),Object(n.jsx)("button",{className:"profile__edit-avatar-button",onClick:e.onEditAvatar,children:Object(n.jsx)("img",{src:b,alt:"",className:"profile__edit-avatar-icon"})})]}),Object(n.jsxs)("div",{className:"profile__info",children:[Object(n.jsx)("h1",{className:"profile__name",children:t.name}),Object(n.jsx)("p",{className:"profile__bio",children:t.about}),Object(n.jsx)("button",{className:"profile__edit-button",onClick:e.onEditProfile})]}),Object(n.jsx)("button",{className:"profile__add-button",onClick:e.onAddPlace})]}),Object(n.jsx)("ul",{className:"elements",children:e.cards.map((function(a){return Object(n.jsx)(h,{card:a,onCardClick:e.onCardClick,onDeleteClick:e.onDeleteClick,onCardLike:e.onLikeClick,currentUser:t},a._id)}))})]})};var m=function(){return Object(n.jsx)("footer",{className:"footer sizer",children:Object(n.jsx)("p",{className:"footer__copyright",children:"\xa9 2020 Mesto Russia"})})};var v=function(e){return Object(n.jsx)("section",{className:"popup fullsize-picture ".concat(e.isOpened&&"popup_opened"),onClick:e.onOverlay,children:Object(n.jsxs)("figure",{className:"popup__container",children:[Object(n.jsx)("button",{type:"button",className:"popup__close-icon",onClick:e.onClose}),Object(n.jsx)("img",{src:e.card.link,alt:e.card.name,className:"popup__picture"}),Object(n.jsx)("figcaption",{className:"popup__caption",children:e.card.name})]})})},O=a(8),_=a(9),g=new(function(){function e(t){Object(O.a)(this,e),this._token=t.token,this._userProfileUrl=t.userProfileUrl,this._cardsUrl=t.cardsUrl}return Object(_.a)(e,[{key:"_handleOriginalJsonResponse",value:function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}},{key:"_handleOriginalResponse",value:function(e){return e.ok?e:Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}},{key:"getUserInfo",value:function(){return fetch(this._userProfileUrl,{headers:{authorization:this._token}}).then(this._handleOriginalJsonResponse).then((function(e){return e})).catch((function(e){console.log(e)}))}},{key:"getCards",value:function(){return fetch(this._cardsUrl,{headers:{authorization:this._token}}).then(this._handleOriginalJsonResponse).then((function(e){return e})).catch((function(e){console.log(e)}))}},{key:"editProfile",value:function(e){var t=e.name,a=e.about;return fetch(this._userProfileUrl,{method:"PATCH",headers:{authorization:this._token,"Content-Type":"application/json"},body:JSON.stringify({name:t,about:a})}).then(this._handleOriginalJsonResponse).then((function(e){return e})).catch((function(e){console.log(e)}))}},{key:"addCard",value:function(e){var t=e.name,a=e.link;return fetch(this._cardsUrl,{method:"POST",headers:{authorization:this._token,"Content-Type":"application/json"},body:JSON.stringify({name:t,link:a})}).then(this._handleOriginalJsonResponse).then((function(e){return e})).catch((function(e){console.log(e)}))}},{key:"deleteCard",value:function(e){return fetch(this._cardsUrl+e,{method:"DELETE",headers:{authorization:this._token}}).then(this._handleOriginalResponse).then((function(e){return e})).catch((function(e){console.log(e)}))}},{key:"like",value:function(e){return fetch(this._cardsUrl+"likes/"+e,{method:"PUT",headers:{authorization:this._token}}).then(this._handleOriginalJsonResponse).then((function(e){return e})).catch((function(e){console.log(e)}))}},{key:"removeLike",value:function(e){return fetch(this._cardsUrl+"likes/"+e,{method:"DELETE",headers:{authorization:this._token}}).then(this._handleOriginalJsonResponse).then((function(e){return e})).catch((function(e){console.log(e)}))}},{key:"changeLikeCardStatus",value:function(e,t){return t?this.removeLike(e):this.like(e)}},{key:"updateAvatar",value:function(e){return fetch(this._userProfileUrl+"avatar/",{method:"PATCH",headers:{authorization:this._token,"Content-Type":"application/json"},body:JSON.stringify({avatar:e})}).then(this._handleOriginalJsonResponse).then((function(e){return e})).catch((function(e){console.log(e)}))}}]),e}())({token:"fe948c7b-c7fe-4065-b9c1-1b820e5df7d7",userProfileUrl:"https://mesto.nomoreparties.co/v1/cohort-17/users/me/",cardsUrl:"https://mesto.nomoreparties.co/v1/cohort-17/cards/"});var x=function(e){return Object(n.jsx)("section",{className:"popup popup_type_".concat(e.name," ").concat(e.isOpened&&"popup_opened"),onClick:e.onOverlay,children:Object(n.jsxs)("form",{className:"popup__container form",name:e.name,onSubmit:e.onSubmit,noValidate:!0,children:[Object(n.jsx)("button",{type:"button",className:"popup__close-icon",onClick:e.onClose}),Object(n.jsx)("h3",{className:"popup__title",children:e.title}),e.children,Object(n.jsx)("button",{type:"submit",className:"popup__submit-button ".concat(e.isValid?"":"popup__submit-button_disabled"),children:e.buttonText})]})})};var k=function(e){var t=o.a.useContext(f),a=o.a.useState({value:t.name,isValid:!0}),i=Object(u.a)(a,2),s=i[0],r=i[1],c=o.a.useState({value:t.about,isvalid:!0}),l=Object(u.a)(c,2),d=l[0],p=l[1],h=o.a.useState(!1),b=Object(u.a)(h,2),j=b[0],m=b[1];return o.a.useEffect((function(){r({value:t.name,isValid:!0}),p({value:t.about,isValid:!0})}),[t]),o.a.useEffect((function(){s.isValid&&d.isValid?m(!0):m(!1)}),[s.isValid,d.isValid]),Object(n.jsxs)(x,{name:"editProfile",title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",isOpened:e.isOpened,onClose:e.onClose,buttonText:e.buttonText,onSubmit:function(t){t.preventDefault(),e.onUpdateUser({name:s.value,about:d.value})},isValid:j,onOverlay:e.onOverlay,children:[Object(n.jsx)("input",{type:"text",className:"popup__input",id:"form-name",name:"name",placeholder:"\u0418\u043c\u044f",required:!0,minLength:"2",maxLength:"40",value:s.value,onChange:function(e){r({value:e.target.value,isValid:e.target.validity.valid,validationMessage:e.target.validationMessage})}}),Object(n.jsx)("span",{className:"popup__input-error form-name-error ".concat(s.isValid?"":"popup__input-error_visible"),children:s.validationMessage}),Object(n.jsx)("input",{type:"text",className:"popup__input",id:"form-bio",name:"bio",placeholder:"\u041e \u0441\u0435\u0431\u0435",required:!0,minLength:"2",maxLength:"200",value:d.value,onChange:function(e){p({value:e.target.value,isValid:e.target.validity.valid,validationMessage:e.target.validationMessage})}}),Object(n.jsx)("span",{className:"popup__input-error form-name-error ".concat(d.isValid?"":"popup__input-error_visible"),children:d.validationMessage})]})};var C=function(e){var t=o.a.useRef(),a=o.a.useState({value:""}),i=Object(u.a)(a,2),s=i[0],r=i[1],c=o.a.useState(!1),l=Object(u.a)(c,2),d=l[0],p=l[1];return o.a.useEffect((function(){s.isValid?p(!0):p(!1)}),[s.isValid]),o.a.useEffect((function(){e.isOpened||r({value:""})}),[e.isOpened]),Object(n.jsxs)(x,{name:"updateAvatar",title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",isOpened:e.isOpened,onClose:e.onClose,buttonText:e.buttonText,onSubmit:function(a){a.preventDefault(),e.onUpdateAvatar(t.current.value)},isValid:d,onOverlay:e.onOverlay,children:[Object(n.jsx)("input",{ref:t,type:"url",className:"popup__input",id:"form-avatar",name:"avatar",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u0430\u0432\u0430\u0442\u0430\u0440",required:!0,minLength:"2",maxLength:"200",value:s.value,onChange:function(e){r({value:e.target.value,isValid:e.target.validity.valid,validationMessage:e.target.validationMessage})}}),Object(n.jsx)("span",{className:"popup__input-error form-avatar-error ".concat(s.isValid?"":"popup__input-error_visible"),children:s.validationMessage})]})};var y=function(e){var t=o.a.useState({value:""}),a=Object(u.a)(t,2),i=a[0],s=a[1],r=o.a.useState({value:""}),c=Object(u.a)(r,2),l=c[0],d=c[1],p=o.a.useState(!1),f=Object(u.a)(p,2),h=f[0],b=f[1];return o.a.useEffect((function(){i.isValid&&l.isValid?b(!0):b(!1)}),[i.isValid,l.isValid]),o.a.useEffect((function(){e.isOpened||(s({value:""}),d({value:""}))}),[e.isOpened]),Object(n.jsxs)(x,{name:"addPlace",title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",isOpened:e.isOpened,onClose:e.onClose,buttonText:e.buttonText,onSubmit:function(t){t.preventDefault(),e.onSubmit({name:i.value,link:l.value})},isValid:h,onOverlay:e.onOverlay,children:[Object(n.jsx)("input",{type:"text",className:"popup__input",id:"form-title",name:"title",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",minLength:"2",maxLength:"30",required:!0,value:i.value,onChange:function(e){s({value:e.target.value,isValid:e.target.validity.valid,validationMessage:e.target.validationMessage})}}),Object(n.jsx)("span",{className:"popup__input-error form-title-error ".concat(i.isValid?"":"popup__input-error_visible"),children:i.validationMessage}),Object(n.jsx)("input",{type:"url",className:"popup__input",id:"form-url",name:"url",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",required:!0,value:l.value,onChange:function(e){d({value:e.target.value,isValid:e.target.validity.valid,validationMessage:e.target.validationMessage})}}),Object(n.jsx)("span",{className:"popup__input-error form-url-error ".concat(l.isValid?"":"popup__input-error_visible"),children:l.validationMessage})]})};var N=function(e){return Object(n.jsx)(x,{name:"confirmDelete",title:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",isOpened:e.isOpened,onClose:e.onClose,buttonText:e.buttonText,onOverlay:e.onOverlay,isValid:!0,onSubmit:function(t){t.preventDefault(),e.onSubmit(e.deleteCard)}})};var S=function(){var e="\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",t="\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435...",a=o.a.useState({name:"User Name",about:"User Bio"}),i=Object(u.a)(a,2),s=i[0],r=i[1],d=o.a.useState(!1),h=Object(u.a)(d,2),b=h[0],O=h[1],_=o.a.useState(!1),x=Object(u.a)(_,2),S=x[0],P=x[1],U=o.a.useState(!1),V=Object(u.a)(U,2),T=V[0],L=V[1],E=o.a.useState(!1),M=Object(u.a)(E,2),A=M[0],D=M[1],J=o.a.useState(!1),z=Object(u.a)(J,2),R=z[0],w=z[1],q=o.a.useState({}),F=Object(u.a)(q,2),I=F[0],B=F[1],H=o.a.useState({addPlace:e,editProfile:e,editAvatar:e,confirmDelete:"\u0414\u0430"}),G=Object(u.a)(H,2),K=G[0],Q=G[1],W=o.a.useState({}),X=Object(u.a)(W,2),Y=X[0],Z=X[1],$=o.a.useState([]),ee=Object(u.a)($,2),te=ee[0],ae=ee[1];function ne(){L(!1),O(!1),P(!1),D(!1),w(!1)}function ie(e){27===e.keyCode&&ne()}function oe(e){e.target===e.currentTarget&&ne()}return o.a.useEffect((function(){Promise.all([g.getUserInfo(),g.getCards()]).then((function(e){var t=Object(u.a)(e,2),a=t[0],n=t[1];r(a),ae(n)}))}),[]),o.a.useEffect((function(){return document.addEventListener("keydown",ie),function(){document.removeEventListener("keydown",ie)}}),[]),Object(n.jsx)("div",{className:"page",children:Object(n.jsxs)(f.Provider,{value:s,children:[Object(n.jsx)(p,{}),Object(n.jsx)(j,{onEditProfile:function(){O(!0)},onAddPlace:function(){P(!0)},onEditAvatar:function(){L(!0)},onCardClick:function(e){B(e),D(!0)},cards:te,onLikeClick:function(e,t){g.changeLikeCardStatus(e._id,t).then((function(t){var a=te.map((function(a){return a._id===e._id?t:a}));ae(a)}))},onDeleteClick:function(e){w(!0),Z(e)}}),Object(n.jsx)(m,{}),Object(n.jsx)(k,{isOpened:b,onClose:ne,onUpdateUser:function(a){var n=a.name,i=a.about;Q(Object(l.a)(Object(l.a)({},K),{},{editProfile:t})),g.editProfile({name:n,about:i}).then((function(t){r(t),Q(Object(l.a)(Object(l.a)({},K),{},{editProfile:e})),ne()}))},buttonText:K.editProfile,onOverlay:oe,escClosing:ie}),Object(n.jsx)(y,{isOpened:S,onClose:ne,onSubmit:function(a){var n=a.name,i=a.link;Q(Object(l.a)(Object(l.a)({},K),{},{addPlace:t})),g.addCard({name:n,link:i}).then((function(t){ae([t].concat(Object(c.a)(te))),Q(Object(l.a)(Object(l.a)({},K),{},{addPlace:e})),ne()}))},buttonText:K.addPlace,onOverlay:oe}),Object(n.jsx)(C,{isOpened:T,onClose:ne,onUpdateAvatar:function(a){Q(Object(l.a)(Object(l.a)({},K),{},{editAvatar:t})),g.updateAvatar(a).then((function(t){r(t),Q(Object(l.a)(Object(l.a)({},K),{},{editAvatar:e})),ne()}))},buttonText:K.editAvatar,onOverlay:oe}),Object(n.jsx)(N,{isOpened:R,onClose:ne,buttonText:K.confirmDelete,onOverlay:oe,onSubmit:function(e){Q(Object(l.a)(Object(l.a)({},K),{},{confirmDelete:"\u0423\u0434\u0430\u043b\u0435\u043d\u0438\u0435..."})),g.deleteCard(e._id).then((function(t){if(t.ok){var a=te.filter((function(t){return t._id!==e._id}));ae(a)}else console.log("\u041e\u0448\u0438\u0431\u043a\u0430: ",t.status);Q(Object(l.a)(Object(l.a)({},K),{},{confirmDelete:"\u0414\u0430"})),ne()}))},deleteCard:Y}),Object(n.jsx)(v,{card:I,isOpened:A,onClose:ne,onOverlay:oe})]})})},P=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,18)).then((function(t){var a=t.getCLS,n=t.getFID,i=t.getFCP,o=t.getLCP,s=t.getTTFB;a(e),n(e),i(e),o(e),s(e)}))};r.a.render(Object(n.jsx)(o.a.StrictMode,{children:Object(n.jsx)(S,{})}),document.getElementById("root")),P()}},[[17,1,2]]]);
//# sourceMappingURL=main.85733ed2.chunk.js.map